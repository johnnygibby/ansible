- hosts: web_servers

- name: set keys 
  tasks:
   - set_fact:
      wlg_rhel_activation_key: "{{'curl -sS  'https://anvsatellite01.wlgore.com/register?activation_keys=RHEL8+Sandbox&lifecycle_environment_id=64&organization_id=1&update_packages=false' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMCwiaWF0IjoxNjc4Mjc5MTc0LCJqdGkiOiI3NGEwOWMyNDk5MWU3M2Q0MDc3NWJlZThkM2QyNWI3YjhkYWYxNzE5YTdiNTI4NmIwNmIwMjhlNjU4MDMzM2NjIiwiZXhwIjoxNzEwNjc5MTc0LCJzY29wZSI6InJlZ2lzdHJhdGlvbiNnbG9iYWwgcmVnaXN0cmF0aW9uI2hvc3QifQ.qkDggh7FnUDIRfxwfXyi73zyKEsSLM1nvejQoqnAQS4' | bash' }}"
    when  'ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'sandbox' or ansible_local is defined and ansible_local.seed is defined and   ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'staging' or ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and   ansible_local.seed.lifecycle_environment | lower == 'testing')'

   - set_fact:
      wlg_rhel_activation_key: "{{'curl -sS  'https://anvsatellite01.wlgore.com/register?activation_keys=RHEL8+Sandbox&lifecycle_environment_id=64&organization_id=1&update_packages=false' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMCwiaWF0IjoxNjc4Mjc5MTc0LCJqdGkiOiI3NGEwOWMyNDk5MWU3M2Q0MDc3NWJlZThkM2QyNWI3YjhkYWYxNzE5YTdiNTI4NmIwNmIwMjhlNjU4MDMzM2NjIiwiZXhwIjoxNzEwNjc5MTc0LCJzY29wZSI6InJlZ2lzdHJhdGlvbiNnbG9iYWwgcmVnaXN0cmF0aW9uI2hvc3QifQ.qkDggh7FnUDIRfxwfXyi73zyKEsSLM1nvejQoqnAQS4' | bash' }}"
    when  '(ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'development' or   ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'education')'

   - set_fact:
      wlg_rhel_activation_key: "{{'curl -sS  'https://anvsatellite01.wlgore.com/register?activation_keys=RHEL8+Sandbox&lifecycle_environment_id=64&organization_id=1&update_packages=false' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMCwiaWF0IjoxNjc4Mjc5MTc0LCJqdGkiOiI3NGEwOWMyNDk5MWU3M2Q0MDc3NWJlZThkM2QyNWI3YjhkYWYxNzE5YTdiNTI4NmIwNmIwMjhlNjU4MDMzM2NjIiwiZXhwIjoxNzEwNjc5MTc0LCJzY29wZSI6InJlZ2lzdHJhdGlvbiNnbG9iYWwgcmVnaXN0cmF0aW9uI2hvc3QifQ.qkDggh7FnUDIRfxwfXyi73zyKEsSLM1nvejQoqnAQS4' | bash' }}"
    when  '(ansible_local is defined and ansible_local.seed is defined and   ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'validation')'

   - set_fact:
      wlg_rhel_activation_key: "{{'curl -sS  'https://anvsatellite01.wlgore.com/register?activation_keys=RHEL8+Sandbox&lifecycle_environment_id=64&organization_id=1&update_packages=false' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMCwiaWF0IjoxNjc4Mjc5MTc0LCJqdGkiOiI3NGEwOWMyNDk5MWU3M2Q0MDc3NWJlZThkM2QyNWI3YjhkYWYxNzE5YTdiNTI4NmIwNmIwMjhlNjU4MDMzM2NjIiwiZXhwIjoxNzEwNjc5MTc0LCJzY29wZSI6InJlZ2lzdHJhdGlvbiNnbG9iYWwgcmVnaXN0cmF0aW9uI2hvc3QifQ.qkDggh7FnUDIRfxwfXyi73zyKEsSLM1nvejQoqnAQS4' | bash' }}"
    when  '(ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and   ansible_local.seed.lifecycle_environment | lower == 'production')'

#USW
   - set_fact:
      wlg_rhel_activation_key: "{{'curl -sS  'https://uswcapsulepd01.wlgore.com:9090/register?activation_keys=USW+RHEL8+Sandbox&lifecycle_environment_id=68&organization_id=1&update_packages=false' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMCwiaWF0IjoxNjc4Mjk1ODQ1LCJqdGkiOiI3MDhhNjZhNjkxMzA1NjFmYjc2MDg3NGRkNWUzMjUzNGY3NTRiMmFlZDU4MTM1ZTRiMWJhNDM0ZGY4ZWZlYzM0IiwiZXhwIjoxNzEwNjk1ODQ1LCJzY29wZSI6InJlZ2lzdHJhdGlvbiNnbG9iYWwgcmVnaXN0cmF0aW9uI2hvc3QifQ.Fy2xjxcb596Wd43tFxvcMgqKYfrxPO3cTTmu47nDCCA' | bash' }}"
    when  'ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'sandbox' or ansible_local is defined and ansible_local.seed is defined and   ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'staging' or ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and   ansible_local.seed.lifecycle_environment | lower == 'testing')'

   - set_fact:
      wlg_rhel_activation_key: "{{'curl -sS  'https://uswcapsulepd01.wlgore.com:9090/register?activation_keys=USW+RHEL8+Sandbox&lifecycle_environment_id=68&organization_id=1&update_packages=false' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMCwiaWF0IjoxNjc4Mjk1ODQ1LCJqdGkiOiI3MDhhNjZhNjkxMzA1NjFmYjc2MDg3NGRkNWUzMjUzNGY3NTRiMmFlZDU4MTM1ZTRiMWJhNDM0ZGY4ZWZlYzM0IiwiZXhwIjoxNzEwNjk1ODQ1LCJzY29wZSI6InJlZ2lzdHJhdGlvbiNnbG9iYWwgcmVnaXN0cmF0aW9uI2hvc3QifQ.Fy2xjxcb596Wd43tFxvcMgqKYfrxPO3cTTmu47nDCCA' | bash' }}"
    when  '(ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'development' or   ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'education')'

   - set_fact:
      wlg_rhel_activation_key: "{{'curl -sS  'https://uswcapsulepd01.wlgore.com:9090/register?activation_keys=USW+RHEL8+Sandbox&lifecycle_environment_id=68&organization_id=1&update_packages=false' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMCwiaWF0IjoxNjc4Mjk1ODQ1LCJqdGkiOiI3MDhhNjZhNjkxMzA1NjFmYjc2MDg3NGRkNWUzMjUzNGY3NTRiMmFlZDU4MTM1ZTRiMWJhNDM0ZGY4ZWZlYzM0IiwiZXhwIjoxNzEwNjk1ODQ1LCJzY29wZSI6InJlZ2lzdHJhdGlvbiNnbG9iYWwgcmVnaXN0cmF0aW9uI2hvc3QifQ.Fy2xjxcb596Wd43tFxvcMgqKYfrxPO3cTTmu47nDCCA' | bash' }}"
    when  '(ansible_local is defined and ansible_local.seed is defined and   ansible_local.seed.lifecycle_environment is defined and ansible_local.seed.lifecycle_environment | lower == 'validation')'

   - set_fact:
      wlg_rhel_activation_key: "{{'curl -sS  'https://uswcapsulepd01.wlgore.com:9090/register?activation_keys=USW+RHEL8+Sandbox&lifecycle_environment_id=68&organization_id=1&update_packages=false' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxMCwiaWF0IjoxNjc4Mjk1ODQ1LCJqdGkiOiI3MDhhNjZhNjkxMzA1NjFmYjc2MDg3NGRkNWUzMjUzNGY3NTRiMmFlZDU4MTM1ZTRiMWJhNDM0ZGY4ZWZlYzM0IiwiZXhwIjoxNzEwNjk1ODQ1LCJzY29wZSI6InJlZ2lzdHJhdGlvbiNnbG9iYWwgcmVnaXN0cmF0aW9uI2hvc3QifQ.Fy2xjxcb596Wd43tFxvcMgqKYfrxPO3cTTmu47nDCCA' | bash' }}"
    when  '(ansible_local is defined and ansible_local.seed is defined and ansible_local.seed.lifecycle_environment is defined and   ansible_local.seed.lifecycle_environment | lower == 'production' and (wlg_region == "usw" or wlg_region == "anc" or wlg_region == "aor"))'

    
    ## JG TEST!!!
    when: wlg_os =="rhel8"
